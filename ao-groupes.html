<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Renovo - Appels d'offres group√©s</title>
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Polices Montserrat -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&amp;display=swap"
    rel="stylesheet"
  />

    <!-- Lien vers le fichier CSS -->
    <link href="css/style.css" rel="stylesheet">
    
    <!-- Lien vers le fichier favicon -->
    <!-- Favicon classique -->
    <link rel="icon" href="IMGs/RENOVO-CERCLE_COULEUR-low_pied-de-page.png" type="image/x-icon">
    <!-- Favicon pour appareils Apple -->
    <link rel="apple-touch-icon" sizes="180x180" href="IMGs/RENOVO-CERCLE_COULEUR-low_pied-de-page.png">
    <!-- Fichier de configuration pour Windows -->
    <link rel="manifest" href="site.webmanifest">

  <!--
  <style>
    body { font-family: 'Montserrat', sans-serif; }
    /* Hero image full-screen */


    .hero {
      background: url('IMGs/renovo-suisse-home-2.jpg') center/cover no-repeat; /* Image de fond */
      color: #fff;
      height: 60vh;                             /* 60% de la hauteur viewport */
      display: flex; align-items: center;       /* centrer verticalement */
      text-shadow: 0 0 8px rgba(0,0,0,0.7);     /* lisibilit√© */
    }
    .hero h1 { font-size: 2.5rem; font-weight: 600; }
    .hero p { font-size: 1.2rem; }

    section { padding: 4rem 0; }
    .section-title { font-weight: 600; color: #5090b6; margin-bottom: 1.5rem; }
    .advantage-list li { margin-bottom: 0.5rem; }

    /* Formulaire */
    #aoForm .form-section { margin-bottom: 2rem; }
    #aoForm .form-section h5 { font-weight: 600; margin-bottom: 1rem; }
    .building-group { border: 1px solid #ccc; border-radius: .5rem; padding: 1rem; margin-bottom: 1rem; }
    .remove-building { cursor: pointer; color: #dc3545; }

  </style>
  -->
</head>
<body>

  <!-- Menu de navigation identique √† la page d'accueil 
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">
        <img src="IMGs/RENOVO-LOGO_COULEUR-med.png" alt="Logo Renovo" style="height:50px;">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Basculer la navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="#mission">Accueil</a></li>
          <li class="nav-item"><a class="nav-link" href="/#services">Prestations</a></li>
          <li class="nav-item"><a class="nav-link" href="/#about">√Ä propos</a></li>
          <li class="nav-item"><a class="nav-link" href="/#contact">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>
  -->

  <!-- Menu de navigation identique √† la page d'accueil -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="IMGs/RENOVO-LOGO_COULEUR-med.png" alt="Logo Renovo" style="height:50px;">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"> 
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html#mission">Accueil</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#services">Prestations</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#about">√Ä propos</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#contact">Contact</a></li>
        </ul>
      </div>
    </div>
</nav>



  <!-- Section 0 : TITRE -->
  <section id="AOgroupes-titre" class="AOgroupes-titre-section">
    <div class="container AOgroupes-titre-content">
      <h1 class="display-4">Appels d'offres group√©s en Suisse romande</h1>
      <p class="lead"></p>
      <p class="lead">Rejoignez d‚Äôautres propri√©taires pour b√©n√©ficier d‚Äôappels d‚Äôoffres mutualis√©s et de conditions attractives.</p>
    </div>
  </section>



  <!-- Section 1 : Prestations -->
  <section id="AOgroupes-prestations" class="AOgroupes-prestations-section">
    <div class="container">
      <div class="row align-items-center">
        <!-- Colonne gauche : Photo -->
        <!--
        <div class="col-md-6 text-center">
          .....
        </div>
        -->

        <!-- Colonne droite : Texte -->

          <h2 class="text-center mb-5">Nos prestations pour les appels d'offres group√©s</h2>
          <p>
            Pour les propri√©taires que ne sont pas des professionnels de l'immobilier, nous organisons chaque ann√©e, des appels d'offres group√©s pour diff√©rents lots. 
            Par exemple un changement de fen√™tres, la r√©novation de la toiture, le changement de la chaudi√®re, etc...
          </p>
          <p>
            Faire partie d'un appel d'offres group√© vous permet de b√©n√©ficier de diff√©rents avantages, par exemple :
          </p>
          <ul>
            <li>Nous r√©digeons un cahier des charges pour que les offres re√ßues des entreprises soient comparable entre elles</li>
            <li>Nous nous assurons que les variantes de travaux les plus pertinentes soient bien int√©gr√©es dans le cahier des charges afin de s'assurer que les solutions les plus optimales soient prises en consid√©ration par les entreprises</li>
            <li>Nous identifions les √©ventuelles interd√©pendances ou effets en cascade que pourraient avoir certains travaux, afin d'optimiser l'investissement ou √©viter toute mauvaise surprise ult√©rieure</li>
            <li>Nous vous proposons une analyse professionnelle et neutre des offres re√ßues et vous sugg√©rons l'offre la plus ad√©quate selon les crit√®res pr√©alablement d√©finis (prix, expertise de l'entreprise, expertise des personnes-cl√©, etc...)</li>
            <li>Lorsque c'est applicable, nous nous assurons que les contr√¥les de garantie et contrats de maintenance soient bien int√©gr√©s dans les prix de l'offre globale des entreprises</li>
            <li>Nous r√©digeons pour vous le contrat d'entreprise pour que vous b√©n√©ficiez des meilleures conditions s'appliquant √† la branche</li>
            <li>Nous intervenons durant le suivi des travaux, selon vos besoins ou dans les cas o√π vous rencontriez des difficult√©s</li>
            <li>Nous participons √† la r√©ception finale des travaux pour valider la qualit√© de la mise en oeuvre</li>
            <li>Nous nous assurons que la documentation de projet est compl√®te et dans le niveau de qualit√© attendu</li>
          </ul>

          <p>
            Un appel d'offres bien r√©dig√© est aussi une mani√®re de susciter l'int√©r√™t d'un panel plus large d'entreprises et de d√©marrer votre projet sur de bonnes bases.
          </p>
          <p>
            Nous vous invitons √† nous informer des diff√©rents √©l√©ments de votre b√¢timent que vous souhaitez r√©nover et l'ann√©e estimative correspondante. 
            Nous vous mettons ainsi dans une liste d'attente et vous contacterons lorsqu'un appel d'offres group√© pourra √™tre organis√© dans votre r√©gion.
          </p>
          <p>
            Le formulaire au bas de cette page vous permet de nous transmettre ces informations. Votre inscription √† cette √©tape est sans engagement de votre part. 
          </p>        
      </div>
    </div>
  </section>


  <!-- Section 2 : Avantages -->
<!--
  <section class="bg-light">
    <div class="container">
      <h2 class="section-title text-center">Avantages pour les propri√©taires</h2>
      <ul class="advantage-list list-unstyled">
        <li>‚úÖ Conditions tarifaires n√©goci√©es gr√¢ce √† l‚Äôeffet de volume</li>
        <li>‚úÖ Processus simplifi√© & unique, pas de d√©marches individuelles multiples</li>
        <li>‚úÖ Expertise AMO RMO pour garantir qualit√©, conformit√© et durabilit√©</li>
        <li>‚úÖ Suivi post-chantiers et s√©curisation de votre investissement</li>
      </ul>
    </div>
  </section>
-->

  <!-- Section 3 : Formulaire AO group√©s -->
  <section id="AOgroupes-formulaire" class="AOgroupes-formulaire-section">

    <div class="container">
      <h2 class="section-title text-center">Manifestez votre int√©r√™t sans engagement</h2>

      <form id="aoForm" action="https://script.google.com/macros/s/AKfycbyLRZg2FwV2lNBZhHFSHcslhnhivwm198zEfQZ8-HnH7DJLhu9oSbuRH9ICsZgVwIoqsA/exec" method="POST">
        
        <!-- Coordonn√©es du propri√©taire -->
        <div class="form-section">
          <h4>1. Vos coordonn√©es</h4>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="firstName" class="form-label">Pr√©nom</label>
              <input type="text" name="firstName" id="firstName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="lastName" class="form-label">Nom</label>
              <input type="text" name="lastName" id="lastName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="email" class="form-label">Email</label>
              <input type="email" name="email" id="email" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="phone" class="form-label">T√©l√©phone</label>
              <input type="tel" name="phone" id="phone" class="form-control">
            </div>
            <p>
                        
            </p>        

          </div>
        </div>

        <!-- Informations sur les b√¢timents -->
        <div class="form-section">
          <h4>2. Informations b√¢timents</h4>
          <div id="buildingsContainer">
            <!-- Bloc mod√®le -->
            <div class="building-group">
              <div class="d-flex justify-content-between">
                <h5><u>B√¢timent n¬∞1</u></h5> 
                <!-- <h5><span class="underline">B√¢timent n¬∞1</span></h5> -->
                <span class="remove-building">&times;</span>
              </div>
              <div class="row g-3">
                <div class="col-md-4">
                  <label class="form-label">Rue & no</label>
                  <input type="text" name="street[]" class="form-control">
                </div>
                <div class="col-md-2">
                  <label class="form-label">NPA</label>
                  <input type="text" name="zip[]" class="form-control">
                </div>
                <div class="col-md-6">
                  <label class="form-label">Ville</label>
                  <input type="text" name="city[]" class="form-control">
                </div>

                <div class="d-flex justify-content-between">
                  <h6>Enveloppe thermique (s√©lectionnez les parties de votre ouvrage que vous envisagez de r√©nover‚ÄØet l'ann√©e souhait√©e pour les travaux)</h6>
                </div>

                <!-- Fen√™tres -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Fen√™tres" name="parts[]">
                    </span>
                    <label class="form-control">Fen√™tres</label>
                    <input type="number" class="form-control" name="year_fenetres" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Fa√ßades -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Fa√ßades" name="parts[]">
                    </span>
                    <label class="form-control">Fa√ßades</label>
                    <input type="number" class="form-control" name="year_facades" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Toiture -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Toiture" name="parts[]">
                    </span>
                    <label class="form-control">Toiture</label>
                    <input type="number" class="form-control" name="year_toiture" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Isolation du sous-sol -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Isolation du sous-sol" name="parts[]">
                    </span>
                    <label class="form-control">Isolation du sous-sol</label>
                    <input type="number" class="form-control" name="year_soussol" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>


                <div class="d-flex justify-content-between">
                  <h6>√ânergies (s√©lectionnez les √©l√©ments techniques que vous envisagez d'installer‚ÄØet l'ann√©e souhait√©e pour les travaux)</h6>
                </div>
                <!-- Panneaux solaires photovolta√Øques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Panneaux photovolta√Øques" name="parts[]">
                    </span>
                    <label class="form-control">Panneaux photovolta√Øques</label>
                    <input type="number" class="form-control" name="year_pv" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Panneaux solaires thermiques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Panneaux thermiques" name="parts[]">
                    </span>
                    <label class="form-control">Panneaux solaires thermiques</label>
                    <input type="number" class="form-control" name="year_thermal" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Production de chaleur -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Production de chaleur" name="parts[]">
                    </span>
                    <label class="form-control">Production de chaleur</label>
                    <input type="number" class="form-control" name="year_heat" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Bornes de recharge √©lectriques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Bornes de recharge √©lectriques" name="parts[]">
                    </span>
                    <label class="form-control">Bornes de recharge √©lectriques</label>
                    <input type="number" class="form-control" name="year_ev" placeholder="Ann√©e travaux" min="2026" max="2035">
                  </div>
                </div>


                <div class="col-12">
                  <label class="form-label">Commentaires</label>
                  <textarea name="comments[]" class="form-control" rows="2"></textarea>
                </div>
                <p>

                </p>        

              </div>
            </div>
          </div>

          <button type="button" id="addBuilding" class="btn btn-outline-secondary btn-sm">
            + Ajouter un b√¢timent
          </button>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary rounded-pill px-4">Envoyer ma demande</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Pied de page identique √† la page d'accueil -->
  <footer class="bg-dark text-white py-3">
    <div class="container text-center">
      <small>&copy; 2025 Renovo. Tous droits r√©serv√©s | info@renovo-suisse.ch</small>
    </div>
  </footer>


  <!-- Scripts Bootstrap & dynamique -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Ajouter/supprimer des b√¢timents -->
  <script>
    const container = document.getElementById('buildingsContainer');
    const addBtn    = document.getElementById('addBuilding');

    // Fonction pour mettre √† jour les num√©ros
    function updateBuildingNumbers() {
      container.querySelectorAll('.building-group').forEach((group, idx) => {
        const title = group.querySelector('h5');
        title.textContent = `B√¢timent n¬∞${idx + 1}`;
      });
    }

    // Ajout d‚Äôun nouveau bloc
    addBtn.addEventListener('click', () => {
      const groups = container.querySelectorAll('.building-group');
      if (groups.length >= 10) {
        return alert('Maximum 10 b√¢timents');
      }

      // Clone profond du premier groupe
      const newGroup = groups[0].cloneNode(true);
      // Vide les champs inputs / textarea
      newGroup.querySelectorAll('input, textarea').forEach(el => el.value = '');
      // R√©inscrire les cases √† cocher d√©coch√©es
      newGroup.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);

      container.appendChild(newGroup);
      updateBuildingNumbers(); // ‚Üê Met √† jour tous les titres
    });

    // Suppression d‚Äôun bloc existant
    container.addEventListener('click', e => {
      if (e.target.classList.contains('remove-building')) {
        const groups = container.querySelectorAll('.building-group');
        if (groups.length > 1) {
          e.target.closest('.building-group').remove();
          updateBuildingNumbers(); // ‚Üê Re-num√©rote apr√®s suppression
        }
      }
    });

    // Initialisation au chargement (au cas o√π)
    updateBuildingNumbers();
</script>

<!-- R√©cup√©rer les donn√©es des b√¢timents 
<script>
  const form = document.getElementById('aoForm');
  form.addEventListener('submit', e => {
    e.preventDefault();

    const buildings = Array.from(document.querySelectorAll('.building-group'))
      .map(group => {
        // On r√©cup√®re TOUTES les checkbox de ce groupe
        const allChecks = Array.from(group.querySelectorAll('input[type=checkbox]'));
        // Pour chaque case coch√©e, on prend sa valeur et l'input number juste √† c√¥t√©
        const parts = [], years = [];
        allChecks.forEach(chk => {
          if (chk.checked) {
            parts.push(chk.value);
            // on cherche l'input[type=number] le plus proche
            const yearInput = chk.closest('.input-group').querySelector('input[type="number"]');
            years.push(yearInput ? yearInput.value : '');
          }
        });
        return {
          street:   group.querySelector('input[name="street[]"]').value,
          zip:      group.querySelector('input[name="zip[]"]').value,
          city:     group.querySelector('input[name="city[]"]').value,
          parts,    // tableau de parties coch√©es
          years,    // tableau des ann√©es correspondantes
          comments: group.querySelector('textarea').value
        };
      });
        

    const payload = new FormData();
 
    // 1. Ajout des coordonn√©es du propri√©taire
    ['firstName','lastName','email','phone'].forEach(k => {
      payload.append(k, form.elements[k].value);
    });

    // 2. Ajout du JSON des b√¢timents
    payload.append('buildings', JSON.stringify(buildings));

    fetch(form.action, { method: 'POST', body: payload })
      .then(r => r.json()).then(res => {
        alert('Donn√©es bien re√ßues‚ÄØüëç');
        form.reset();
      }).catch(err => {
        console.error(err);
        alert('Erreur lors de l‚Äôenvoi.');
      });
  });
</script>
-->

<!-- R√©cup√©rer les donn√©es des b√¢timents 
<script>
  document.getElementById('ao-form').addEventListener('submit', function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    const buildings = [];
    document.querySelectorAll('.building-group').forEach(group => {
      const parts = [];
      group.querySelectorAll('input[name="parts[]"]:checked').forEach(cb => parts.push(cb.value));

      buildings.push({
        street: group.querySelector('input[name="street[]"]').value,
        zip: group.querySelector('input[name="zip[]"]').value,
        city: group.querySelector('input[name="city[]"]').value,
        parts: parts,
        year_fenetres: group.querySelector('input[name="year_fenetres"]')?.value || '',
        year_facades: group.querySelector('input[name="year_facades"]')?.value || '',
        year_toiture: group.querySelector('input[name="year_toiture"]')?.value || '',
        year_soussol: group.querySelector('input[name="year_soussol"]')?.value || '',
        year_pv: group.querySelector('input[name="year_pv"]')?.value || '',
        year_thermal: group.querySelector('input[name="year_thermal"]')?.value || '',
        year_heat: group.querySelector('input[name="year_heat"]')?.value || '',
        year_ev: group.querySelector('input[name="year_ev"]')?.value || '',
        comments: group.querySelector('textarea[name="comments[]"]').value
      });
    });

    const payload = new FormData();
    payload.append('firstName', form.querySelector('input[name="firstName"]').value);
    payload.append('lastName', form.querySelector('input[name="lastName"]').value);
    payload.append('email', form.querySelector('input[name="email"]').value);
    payload.append('phone', form.querySelector('input[name="phone"]').value);
    if (form.querySelector('input[name="sendCopy"]')?.checked) {
      payload.append('sendCopy', 'on');
    }
    payload.append('buildings', JSON.stringify(buildings));

    fetch(form.action, {
      method: 'POST',
      body: payload
    })
      .then(response => response.json())
      .then(data => {
        if (data.result === 'success') {
          alert('Votre demande a √©t√© envoy√©e avec succ√®s.');
          form.reset();
        } else {
          alert('Erreur : ' + (data.result || 'inconnue'));
        }
      })
      .catch(error => {
        console.error('Erreur lors de l‚Äôenvoi :', error);
        alert('Erreur lors de l‚Äôenvoi.');
      });
  });
</script>
-->

<script>
  // Ce code JS emp√™che la redirection vers l'URL Google Apps Script (comportement par d√©faut de fetch si on ne traite pas la r√©ponse)

document.getElementById('ao-form').addEventListener('submit', function (e) {
  e.preventDefault();

  const form = e.target;
  const buildings = [];

  document.querySelectorAll('.building-group').forEach(group => {
    const parts = [];
    group.querySelectorAll('input[name="parts[]"]:checked').forEach(cb => parts.push(cb.value));

    buildings.push({
      street: group.querySelector('input[name="street[]"]').value,
      zip: group.querySelector('input[name="zip[]"]').value,
      city: group.querySelector('input[name="city[]"]').value,
      parts: parts,
      year_fenetres: group.querySelector('input[name="year_fenetres"]')?.value || '',
      year_facades: group.querySelector('input[name="year_facades"]')?.value || '',
      year_toiture: group.querySelector('input[name="year_toiture"]')?.value || '',
      year_soussol: group.querySelector('input[name="year_soussol"]')?.value || '',
      year_pv: group.querySelector('input[name="year_pv"]')?.value || '',
      year_thermal: group.querySelector('input[name="year_thermal"]')?.value || '',
      year_heat: group.querySelector('input[name="year_heat"]')?.value || '',
      year_ev: group.querySelector('input[name="year_ev"]')?.value || '',
      comments: group.querySelector('textarea[name="comments[]"]').value
    });
  });

  const payload = new FormData();
  payload.append('firstName', form.querySelector('input[name="firstName"]').value);
  payload.append('lastName', form.querySelector('input[name="lastName"]').value);
  payload.append('email', form.querySelector('input[name="email"]').value);
  payload.append('phone', form.querySelector('input[name="phone"]').value);
  if (form.querySelector('input[name="sendCopy"]')?.checked) {
    payload.append('sendCopy', 'on');
  }
  payload.append('buildings', JSON.stringify(buildings));

  fetch(form.action, {
    method: 'POST',
    body: payload
  })
    .then(response => {
      if (response.redirected) {
        return response.text().then(html => {
          alert('Votre demande a √©t√© envoy√©e avec succ√®s.');
          form.reset();
        });
      }
      return response.json();
    })
    .then(data => {
      if (data && data.result === 'success') {
        alert('Votre demande a √©t√© envoy√©e avec succ√®s.');
        form.reset();
      } else if (data && data.result) {
        alert('Erreur : ' + data.result);
      }
    })
    .catch(error => {
      console.error('Erreur lors de l‚Äôenvoi :', error);
      alert('Une erreur s‚Äôest produite lors de l‚Äôenvoi du formulaire.');
    });
});

</script>


</body>
</html>
