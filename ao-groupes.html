<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Renovo - Appels d'offres groupés</title>
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Polices Montserrat -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&amp;display=swap"
    rel="stylesheet"
  />

    <!-- Lien vers le fichier CSS -->
    <link href="css/style.css" rel="stylesheet">
    
    <!-- Lien vers le fichier favicon -->
    <!-- Favicon classique -->
    <link rel="icon" href="IMGs/RENOVO-CERCLE_COULEUR-low_pied-de-page.png" type="image/x-icon">
    <!-- Favicon pour appareils Apple -->
    <link rel="apple-touch-icon" sizes="180x180" href="IMGs/RENOVO-CERCLE_COULEUR-low_pied-de-page.png">
    <!-- Fichier de configuration pour Windows -->
    <link rel="manifest" href="site.webmanifest">
</head>
<body>

  <!-- Menu de navigation identique à la page d'accueil -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="IMGs/RENOVO-LOGO_COULEUR-med.png" alt="Logo Renovo" style="height:50px;">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"> 
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html#mission">Accueil</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#services">Prestations</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#about">À propos</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#contact">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Section 0 : TITRE -->
  <section id="AOgroupes-titre" class="AOgroupes-titre-section">
    <div class="container AOgroupes-titre-content">
      <h1 class="display-4">Appels d'offres groupés en Suisse romande</h1>
      <p class="lead"></p>
      <p class="lead">Rejoignez d’autres propriétaires pour bénéficier d’appels d’offres mutualisés et de conditions attractives.</p>
    </div>
  </section>



  <!-- Section 1 : Prestations -->
  <section id="AOgroupes-prestations" class="AOgroupes-prestations-section">
    <div class="container">
      <div class="row align-items-center">
        <!-- Colonne gauche : Photo -->
        <!--
        <div class="col-md-6 text-center">
          .....
        </div>
        -->

        <!-- Colonne droite : Texte -->

          <h2 class="text-center mb-5">Nos prestations pour les appels d'offres groupés</h2>
          <p>
            Pour les propriétaires que ne sont pas des professionnels de l'immobilier, nous organisons chaque année, des appels d'offres groupés pour différents lots. 
            Par exemple un changement de fenêtres, la rénovation de la toiture, le changement de la chaudière, etc...
          </p>
          <p>
            Faire partie d'un appel d'offres groupé vous permet de bénéficier de différents avantages, par exemple :
          </p>
          <ul>
            <li>Nous rédigeons un cahier des charges pour que les offres reçues des entreprises soient comparable entre elles</li>
            <li>Nous nous assurons que les variantes de travaux les plus pertinentes soient bien intégrées dans le cahier des charges afin de s'assurer que les solutions les plus optimales soient prises en considération par les entreprises</li>
            <li>Nous identifions les éventuelles interdépendances ou effets en cascade que pourraient avoir certains travaux, afin d'optimiser l'investissement ou éviter toute mauvaise surprise ultérieure</li>
            <li>Nous vous proposons une analyse professionnelle et neutre des offres reçues et vous suggérons l'offre la plus adéquate selon les critères préalablement définis (prix, expertise de l'entreprise, expertise des personnes-clé, etc...)</li>
            <li>Lorsque c'est applicable, nous nous assurons que les contrôles de garantie et contrats de maintenance soient bien intégrés dans les prix de l'offre globale des entreprises</li>
            <li>Nous rédigeons pour vous le contrat d'entreprise pour que vous bénéficiez des meilleures conditions s'appliquant à la branche</li>
            <li>Nous intervenons durant le suivi des travaux, selon vos besoins ou dans les cas où vous rencontriez des difficultés</li>
            <li>Nous participons à la réception finale des travaux pour valider la qualité de la mise en oeuvre</li>
            <li>Nous nous assurons que la documentation de projet est complète et dans le niveau de qualité attendu</li>
          </ul>

          <p>
            Un appel d'offres bien rédigé est aussi une manière de susciter l'intérêt d'un panel plus large d'entreprises et de démarrer votre projet sur de bonnes bases.
          </p>
          <p>
            Nous vous invitons à nous informer des différents éléments de votre bâtiment que vous souhaitez rénover et l'année estimative correspondante. 
            Nous vous mettons ainsi dans une liste d'attente et vous contacterons lorsqu'un appel d'offres groupé pourra être organisé dans votre région.
          </p>
          <p>
            Le formulaire au bas de cette page vous permet de nous transmettre ces informations. Votre inscription à cette étape est sans engagement de votre part. 
          </p>        
      </div>
    </div>
  </section>


  <!-- Section 3 : Formulaire AO groupés -->
  <section id="AOgroupes-formulaire" class="AOgroupes-formulaire-section">

    <div class="container">
      <h2 class="section-title text-center">Manifestez votre intérêt sans engagement</h2>

      <form id="aoForm" action="https://script.google.com/macros/s/AKfycbzWE62ATn3tyUwhvsVKVHW6y6q_RGeaLU1sYGpyUCZSPE4Lf-lyTRUOjvW8kUBWgqGBKw/exec" method="POST">
        
        <!-- Coordonnées du propriétaire -->
        <div class="form-section">
          <h4>1. Vos coordonnées</h4>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="firstName" class="form-label">Prénom</label>
              <input type="text" name="firstName" id="firstName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="lastName" class="form-label">Nom</label>
              <input type="text" name="lastName" id="lastName" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="email" class="form-label">Email</label>
              <input type="email" name="email" id="email" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label for="phone" class="form-label">Téléphone</label>
              <input type="tel" name="phone" id="phone" class="form-control">
            </div>
            <p>
                        
            </p>        

          </div>
        </div>

        <!-- Informations sur les bâtiments -->
        <div class="form-section">
          <h4>2. Informations bâtiments</h4>
          <div id="buildingsContainer">
            <!-- Bloc modèle -->
            <div class="building-group">
              <div class="d-flex justify-content-between">
                <h5><u>Bâtiment n°1</u></h5> 
                <!-- <h5><span class="underline">Bâtiment n°1</span></h5> -->
                <span class="remove-building">&times;</span>
              </div>
              <div class="row g-3">
                <div class="col-md-4">
                  <label class="form-label">Rue & no</label>
                  <input type="text" name="street[]" class="form-control">
                </div>
                <div class="col-md-2">
                  <label class="form-label">NPA</label>
                  <input type="text" name="zip[]" class="form-control">
                </div>
                <div class="col-md-6">
                  <label class="form-label">Ville</label>
                  <input type="text" name="city[]" class="form-control">
                </div>

                <div class="d-flex justify-content-between">
                  <h6>Enveloppe thermique (sélectionnez les parties de votre ouvrage que vous envisagez de rénover et l'année souhaitée pour les travaux)</h6>
                </div>

                <!-- Fenêtres -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Fenêtres" name="parts[]">
                    </span>
                    <label class="form-control">Fenêtres</label>
                    <input type="number" class="form-control" name="year_fenetres" placeholder="Année travaux" min="2026" max="2035">
                    <!-- <input type="number" class="form-control" name="year_fenetres" placeholder="Année fenêtres" min="2026" max="2035"> -->

                  </div>
                </div>
                <!-- Façades -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Façades" name="parts[]">
                    </span>
                    <label class="form-control">Façades</label>
                    <input type="number" class="form-control" name="year_facades" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Toiture -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Toiture" name="parts[]">
                    </span>
                    <label class="form-control">Toiture</label>
                    <input type="number" class="form-control" name="year_toiture" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Isolation du sous-sol -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Isolation du sous-sol" name="parts[]">
                    </span>
                    <label class="form-control">Isolation du sous-sol</label>
                    <input type="number" class="form-control" name="year_soussol" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>


                <div class="d-flex justify-content-between">
                  <h6>Énergies (sélectionnez les éléments techniques que vous envisagez d'installer et l'année souhaitée pour les travaux)</h6>
                </div>
                <!-- Panneaux solaires photovoltaïques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Panneaux photovoltaïques" name="parts[]">
                    </span>
                    <label class="form-control">Panneaux photovoltaïques</label>
                    <input type="number" class="form-control" name="year_pv" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Panneaux solaires thermiques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Panneaux thermiques" name="parts[]">
                    </span>
                    <label class="form-control">Panneaux solaires thermiques</label>
                    <input type="number" class="form-control" name="year_thermal" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Production de chaleur -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Production de chaleur" name="parts[]">
                    </span>
                    <label class="form-control">Production de chaleur</label>
                    <input type="number" class="form-control" name="year_heat" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>
                <!-- Bornes de recharge électriques -->
                <div class="col-12 col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">
                      <input class="form-check-input mt-0" type="checkbox" value="Bornes de recharge électriques" name="parts[]">
                    </span>
                    <label class="form-control">Bornes de recharge électriques</label>
                    <input type="number" class="form-control" name="year_ev" placeholder="Année travaux" min="2026" max="2035">
                  </div>
                </div>


                <div class="col-12">
                  <label class="form-label">Commentaires</label>
                  <textarea name="comments[]" class="form-control" rows="2"></textarea>
                </div>
                <p>

                </p>        

              </div>
            </div>
          </div>

          <button type="button" id="addBuilding" class="btn btn-outline-secondary btn-sm">
            + Ajouter un bâtiment
          </button>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary rounded-pill px-4">Envoyer ma demande</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Pied de page identique à la page d'accueil -->
  <footer class="bg-dark text-white py-3">
    <div class="container text-center">
      <small>&copy; 2025 Renovo. Tous droits réservés | info@renovo-suisse.ch</small>
    </div>
  </footer>


  <!-- Scripts Bootstrap & dynamique -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


  <!-- Ajouter de nouveaux bâtiments -->
  <script>
    const container = document.getElementById('buildingsContainer');
    const addBtn    = document.getElementById('addBuilding');

    // Fonction pour mettre à jour les numéros
    function updateBuildingNumbers() {
      container.querySelectorAll('.building-group').forEach((group, idx) => {
        const title = group.querySelector('h5');
        title.textContent = `Bâtiment n°${idx + 1}`;
      });
    }

    // Ajout d’un nouveau bloc
    addBtn.addEventListener('click', () => {
      const groups = container.querySelectorAll('.building-group');
      if (groups.length >= 10) {
        return alert('Maximum 10 bâtiments');
      }

      // Clone profond du premier groupe
      const newGroup = groups[0].cloneNode(true);
      // Vide les champs inputs / textarea
      newGroup.querySelectorAll('input, textarea').forEach(el => el.value = '');
      // Réinscrire les cases à cocher décochées
      newGroup.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);

      container.appendChild(newGroup);
      updateBuildingNumbers(); // ← Met à jour tous les titres
    });

    // Suppression d’un bloc existant
    container.addEventListener('click', e => {
      if (e.target.classList.contains('remove-building')) {
        const groups = container.querySelectorAll('.building-group');
        if (groups.length > 1) {
          e.target.closest('.building-group').remove();
          updateBuildingNumbers(); // ← Re-numérote après suppression
        }
      }
    });

    // Initialisation au chargement (au cas où)
    updateBuildingNumbers();
</script>

<!-- Récolter les données des bâtiments 

<script>
  const form = document.getElementById('aoForm');
  form.addEventListener('submit', e => {
    e.preventDefault();

    const buildings = Array.from(document.querySelectorAll('.building-group'))
      .map(group => {
        // On récupère TOUTES les checkbox de ce groupe
        const allChecks = Array.from(group.querySelectorAll('input[type=checkbox]'));
        // Pour chaque case cochée, on prend sa valeur et l'input number juste à côté
        const parts = [], years = [];
        allChecks.forEach(chk => {
          if (chk.checked) {
            parts.push(chk.value);
            // on cherche l'input[type=number] le plus proche
            const yearInput = chk.closest('.input-group').querySelector('input[type="number"]');
            years.push(yearInput ? yearInput.value : '');
          }
        });
        return {
          street:   group.querySelector('input[name="street[]"]').value,
          zip:      group.querySelector('input[name="zip[]"]').value,
          city:     group.querySelector('input[name="city[]"]').value,
          parts,    // tableau de parties cochées
          years,    // tableau des années correspondantes
          comments: group.querySelector('textarea').value
        };
      });

    const payload = new FormData();
 
    // 1. Ajout des coordonnées du propriétaire
    ['firstName','lastName','email','phone'].forEach(k => {
      payload.append(k, form.elements[k].value);
    });

    // 2. Ajout du JSON des bâtiments
    payload.append('buildings', JSON.stringify(buildings));

    fetch(form.action, { method: 'POST', body: payload })
      .then(r => r.json()).then(res => {
        alert('Données bien reçues 👍');
        form.reset();
      }).catch(err => {
        console.error(err);
        alert('Erreur lors de l’envoi.');
      });
  });
</script>
-->


<!-- Récupérer les données des bâtiments
<script>
    // Ce code JS empêche la redirection vers l'URL Google Apps Script (comportement par défaut de fetch si on ne traite pas la réponse)

  document.getElementById('ao-form').addEventListener('submit', function (e) {
    e.preventDefault();

    const form = e.target;
    const buildings = [];

    document.querySelectorAll('.building-group').forEach(group => {
      const parts = [];
      group.querySelectorAll('input[name="parts[]"]:checked').forEach(cb => parts.push(cb.value));

      buildings.push({
        street: group.querySelector('input[name="street[]"]').value,
        zip: group.querySelector('input[name="zip[]"]').value,
        city: group.querySelector('input[name="city[]"]').value,
        parts: parts,
        year_fenetres: group.querySelector('input[name="year_fenetres"]')?.value || '',
        year_facades: group.querySelector('input[name="year_facades"]')?.value || '',
        year_toiture: group.querySelector('input[name="year_toiture"]')?.value || '',
        year_soussol: group.querySelector('input[name="year_soussol"]')?.value || '',
        year_pv: group.querySelector('input[name="year_pv"]')?.value || '',
        year_thermal: group.querySelector('input[name="year_thermal"]')?.value || '',
        year_heat: group.querySelector('input[name="year_heat"]')?.value || '',
        year_ev: group.querySelector('input[name="year_ev"]')?.value || '',
        comments: group.querySelector('textarea[name="comments[]"]').value
      });
    });

    const payload = new FormData();
    payload.append('firstName', form.querySelector('input[name="firstName"]').value);
    payload.append('lastName', form.querySelector('input[name="lastName"]').value);
    payload.append('email', form.querySelector('input[name="email"]').value);
    payload.append('phone', form.querySelector('input[name="phone"]').value);
    if (form.querySelector('input[name="sendCopy"]')?.checked) {
      payload.append('sendCopy', 'on');
    }
    payload.append('buildings', JSON.stringify(buildings));

    fetch(form.action, {
      method: 'POST',
      body: payload
    })
      .then(response => {
        if (response.redirected) {
          return response.text().then(html => {
            alert('Votre demande a été envoyée avec succès.');
            form.reset();
          });
        }
        return response.json();
      })
      .then(data => {
        if (data && data.result === 'success') {
          alert('Votre demande a été envoyée avec succès.');
          form.reset();
        } else if (data && data.result) {
          alert('Erreur : ' + data.result);
        }
      })
      .catch(error => {
        console.error('Erreur lors de l’envoi :', error);
        alert('Une erreur s’est produite lors de l’envoi du formulaire.');
      });
  });

</script>
-->


<!-- Récupérer les données des bâtiments-->
<script>
    // Ce code JS empêche la redirection vers l'URL Google Apps Script (comportement par défaut de fetch si on ne traite pas la réponse)

  document.getElementById('ao-form').addEventListener('submit', function (e) {
    e.preventDefault();

    const form = e.target;
    const buildings = [];

    document.querySelectorAll('.building-group').forEach(group => {
      const parts = [];
      group.querySelectorAll('input[name="parts[]"]:checked').forEach(cb => parts.push(cb.value));

      buildings.push({
        street: group.querySelector('input[name="street[]"]').value,
        zip: group.querySelector('input[name="zip[]"]').value,
        city: group.querySelector('input[name="city[]"]').value,
        parts: parts,
        year_fenetres: group.querySelector('input[name="year_fenetres"]')?.value || '',
        year_facades: group.querySelector('input[name="year_facades"]')?.value || '',
        year_toiture: group.querySelector('input[name="year_toiture"]')?.value || '',
        year_soussol: group.querySelector('input[name="year_soussol"]')?.value || '',
        year_pv: group.querySelector('input[name="year_pv"]')?.value || '',
        year_thermal: group.querySelector('input[name="year_thermal"]')?.value || '',
        year_heat: group.querySelector('input[name="year_heat"]')?.value || '',
        year_ev: group.querySelector('input[name="year_ev"]')?.value || '',
        comments: group.querySelector('textarea[name="comments[]"]').value
      });
    });

    const payload = new FormData();
    payload.append('firstName', form.querySelector('input[name="firstName"]').value);
    payload.append('lastName', form.querySelector('input[name="lastName"]').value);
    payload.append('email', form.querySelector('input[name="email"]').value);
    payload.append('phone', form.querySelector('input[name="phone"]').value);
    if (form.querySelector('input[name="sendCopy"]')?.checked) {
      payload.append('sendCopy', 'on');
    }
    payload.append('buildings', JSON.stringify(buildings));

    fetch(form.action, {
      method: 'POST',
      body: payload
    })
      .then(response => {
        if (response.redirected) {
          return response.text().then(html => {
            alert('Votre demande a été envoyée avec succès.');
            form.reset();
          });
        }
        return response.json();
      })
      .then(data => {
        if (data && data.result === 'success') {
          alert('Votre demande a été envoyée avec succès.');
          form.reset();
        } else if (data && data.result) {
          alert('Erreur : ' + data.result);
        }
      })
      .catch(error => {
        console.error('Erreur lors de l’envoi :', error);
        alert('Une erreur s’est produite lors de l’envoi du formulaire.');
      });
  });

</script>




</body>
</html>
